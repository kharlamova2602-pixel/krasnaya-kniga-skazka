<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>–ó–∞–¥–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–π ‚Äî –ß–µ—Ä–µ–ø–∞—à–∏–π —É–≥–æ–ª–æ–∫</title>
  <style>
    :root{
      --bg1:#dff7ee;
      --bg2:#e9f6ff;
      --card:#ffffffcc;
      --stroke:rgba(0,0,0,.08);
      --shadow: 0 18px 45px rgba(0,0,0,.12);
      --blue:#2d7cf7;
      --teal:#14b8a6;
      --amber:#f59e0b;
      --text:#10324a;
      --muted:#4e6b7d;
      --pill:#ffffffc9;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% 20%, var(--bg2), transparent 60%),
        radial-gradient(1000px 700px at 80% 10%, var(--bg1), transparent 60%),
        linear-gradient(180deg, #f3fff9 0%, #e9fbff 100%);
      min-height:100vh;
    }
    body[data-bg="meadow"]{
      --bg1:#dff7ee; --bg2:#e9f6ff;
      background:
        radial-gradient(1200px 700px at 20% 20%, var(--bg2), transparent 60%),
        radial-gradient(1000px 700px at 80% 10%, var(--bg1), transparent 60%),
        linear-gradient(180deg, #f3fff9 0%, #e9fbff 100%);
    }
    body[data-bg="lake"]{
      --bg1:#d7f3ff; --bg2:#e7fbff;
      background:
        radial-gradient(1100px 650px at 20% 20%, #e9fbff, transparent 60%),
        radial-gradient(1100px 650px at 75% 15%, #d7f3ff, transparent 60%),
        linear-gradient(180deg, #f2fbff 0%, #e7fbff 100%);
    }
    body[data-bg="steppe"]{
      --bg1:#fff2d7; --bg2:#eafff2;
      background:
        radial-gradient(1100px 650px at 20% 20%, #fff7e6, transparent 60%),
        radial-gradient(1100px 650px at 75% 15%, #e9fff3, transparent 60%),
        linear-gradient(180deg, #fffaf0 0%, #eafff2 100%);
    }
    body[data-bg="night"]{
      --text:#eaf7ff; --muted:#c6d8e7;
      --card:rgba(12,22,35,.68);
      --stroke:rgba(255,255,255,.10);
      --pill:rgba(255,255,255,.10);
      background:
        radial-gradient(1200px 700px at 20% 20%, rgba(40,130,255,.20), transparent 60%),
        radial-gradient(900px 700px at 80% 10%, rgba(20,240,190,.14), transparent 60%),
        linear-gradient(180deg, #071625 0%, #06101b 100%);
    }

    .wrap{max-width:1180px;margin:0 auto;padding:22px 16px 70px}
    .topbar{
      display:flex;align-items:center;gap:14px;justify-content:space-between;
      padding:14px 16px;border:1px solid var(--stroke);
      border-radius:18px;background:var(--card);box-shadow:var(--shadow);
      backdrop-filter: blur(10px);
    }
    .brand{display:flex;align-items:center;gap:12px;min-width:260px}
    .emblem{
      width:62px;height:62px;border-radius:16px;object-fit:contain;
      background:rgba(255,255,255,.5);border:1px solid var(--stroke);
      padding:6px;
    }
    .brand h1{margin:0;font-size:16px;line-height:1.1}
    .brand small{display:block;color:var(--muted);margin-top:2px}

    .controls{display:flex;align-items:center;gap:10px;flex-wrap:wrap;justify-content:flex-end}
    .pill{
      display:flex;gap:6px;align-items:center;
      background:var(--pill);border:1px solid var(--stroke);
      border-radius:999px;padding:6px 8px;
    }
    .btn{
      border:1px solid var(--stroke);
      background:#fff; color:var(--text);
      border-radius:999px;
      padding:8px 12px;
      font-weight:800;
      cursor:pointer;
      transition:.15s transform,.15s opacity,.15s background;
      user-select:none;
      text-decoration:none;
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
    }
    body[data-bg="night"] .btn{background:rgba(255,255,255,.10);color:var(--text)}
    .btn:hover{transform:translateY(-1px)}
    .btn.active{background:linear-gradient(90deg,#36c2ff,#2d7cf7); color:white; border-color:transparent}
    .btn.small{padding:7px 10px;font-weight:900}
    .btn.primary{
      background:linear-gradient(90deg,#36c2ff,#2d7cf7);
      color:#fff;border-color:transparent;
    }
    .btn.teal{
      background:linear-gradient(90deg,#2ee7c8,#14b8a6);
      color:#053b3b;border-color:transparent;font-weight:1000;
    }
    .btn.amber{
      background:linear-gradient(90deg,#ffd36b,#f59e0b);
      color:#4a2a00;border-color:transparent;font-weight:1000;
    }
    .btn.ghost{background:transparent}

    .hero{
      margin-top:18px;
      border-radius:22px;
      border:1px solid var(--stroke);
      background:var(--card);
      box-shadow:var(--shadow);
      padding:22px 18px 16px;
      text-align:center;
    }
    .hero h2{margin:0 0 8px;font-size:30px}
    .hero p{margin:0 auto;max-width:900px;color:var(--muted);line-height:1.45}
    .row{margin-top:14px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
    .statRow{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:12px}
    .stat{
      background:rgba(255,255,255,.55);
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:10px 12px;
      min-width:160px;
      text-align:left;
      box-shadow:0 10px 20px rgba(0,0,0,.08);
    }
    body[data-bg="night"] .stat{background:rgba(255,255,255,.06)}
    .stat b{display:block;font-size:13px}
    .stat span{color:var(--muted);font-weight:900}

    .panel{
      margin-top:16px;
      border:1px solid var(--stroke);
      border-radius:18px;
      background:var(--card);
      box-shadow:0 14px 28px rgba(0,0,0,.10);
      overflow:hidden;
    }
    .panelHead{
      display:flex;align-items:center;justify-content:space-between;
      gap:10px;
      padding:14px 14px;
      border-bottom:1px solid var(--stroke);
      flex-wrap:wrap;
    }
    .panelHead h3{margin:0;font-size:16px}
    .panelBody{padding:14px}
    .form{
      display:flex;gap:10px;justify-content:center;flex-wrap:wrap;align-items:center;
    }
    input[type="text"]{
      border:1px solid var(--stroke);
      border-radius:999px;
      padding:10px 12px;
      min-width:min(380px, 90vw);
      background:rgba(255,255,255,.8);
      font-weight:800;
      color:var(--text);
      outline:none;
    }
    body[data-bg="night"] input[type="text"]{background:rgba(255,255,255,.08);color:var(--text)}
    .hint{color:var(--muted);font-weight:800;text-align:center;margin:8px 0 0}

    .levels{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:12px}
    @media (max-width: 980px){ .levels{grid-template-columns:1fr} }

    details.level{
      border:1px solid var(--stroke);
      border-radius:16px;
      background:rgba(255,255,255,.55);
      padding:10px 12px;
      box-shadow:0 10px 18px rgba(0,0,0,.08);
    }
    body[data-bg="night"] details.level{background:rgba(255,255,255,.06)}
    details.level summary{
      cursor:pointer;
      list-style:none;
      font-weight:1000;
      display:flex;align-items:center;justify-content:space-between;
      gap:10px;
    }
    details.level summary::-webkit-details-marker{display:none}
    .badge{
      font-size:12px;
      font-weight:1000;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.75);
      color:var(--muted);
    }
    body[data-bg="night"] .badge{background:rgba(255,255,255,.08);color:var(--muted)}

    .q{
      border:1px dashed rgba(0,0,0,.15);
      border-radius:14px;
      padding:10px 10px;
      margin:10px 0 0;
      background:rgba(255,255,255,.55);
    }
    body[data-bg="night"] .q{border-color:rgba(255,255,255,.18);background:rgba(255,255,255,.05)}
    .q p{margin:0 0 8px;font-weight:1000}
    .opt{display:flex;gap:8px;align-items:flex-start;margin:6px 0}
    .opt input{margin-top:4px}
    .opt label{cursor:pointer;color:var(--muted);font-weight:850;line-height:1.25}

    .mini{
      display:grid;
      grid-template-columns:1.2fr .8fr;
      gap:12px;
      margin-top:14px;
    }
    @media (max-width: 980px){ .mini{grid-template-columns:1fr} }
    .box{
      border:1px solid var(--stroke);
      border-radius:16px;
      padding:12px;
      background:rgba(255,255,255,.55);
    }
    body[data-bg="night"] .box{background:rgba(255,255,255,.06)}
    .box h4{margin:0 0 8px;font-size:14px}
    .box .list{margin:0;padding-left:18px;color:var(--muted);font-weight:850;line-height:1.35}

    .divider{height:1px;background:var(--stroke);margin:14px 0}
    .footer{
      margin-top:18px;
      text-align:center;
      color:var(--muted);
      font-size:12px;
      padding:10px 0 0;
      font-weight:800;
    }

    /* Certificate */
    .certWrap{display:none;margin-top:16px}
    .cert{
      position:relative;
      border-radius:22px;
      border:1px solid var(--stroke);
      background:var(--card);
      box-shadow:var(--shadow);
      padding:18px 16px 16px;
      overflow:hidden;
      text-align:left;
    }
    .certTop{display:flex;gap:14px;align-items:center;flex-wrap:wrap}
    .certTop img{
      width:76px;height:76px;object-fit:contain;
      background:rgba(255,255,255,.55);
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:8px;
    }
    body[data-bg="night"] .certTop img{background:rgba(255,255,255,.08)}
    .certTitle{margin:0;font-size:22px;font-weight:1000}
    .certSub{margin:4px 0 0;color:var(--muted);font-weight:900}
    .certLine{margin:10px 0 0;color:var(--muted);font-weight:900}
    .certBig{margin:6px 0 0;font-size:18px;font-weight:1100}
    .certMeta{margin-top:10px;display:flex;gap:10px;flex-wrap:wrap}
    .chip{
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.55);
      border-radius:999px;
      padding:8px 10px;
      font-weight:1000;
      color:var(--muted);
    }
    body[data-bg="night"] .chip{background:rgba(255,255,255,.08)}

    /* Fairy certificate upgrade */
    .cert{
      position:relative;
      border:3px solid rgba(80,140,255,.55);
      background:
        radial-gradient(1000px 500px at 15% 0%, rgba(54,194,255,.22), transparent 55%),
        radial-gradient(1000px 500px at 85% 0%, rgba(46,231,200,.18), transparent 55%),
        radial-gradient(900px 520px at 50% 110%, rgba(245,158,11,.16), transparent 55%),
        rgba(255,255,255,.72);
    }
    .cert:before{
      content:"";
      position:absolute; inset:-10px;
      border-radius:22px;
      background: linear-gradient(90deg, rgba(54,194,255,.25), rgba(46,231,200,.18), rgba(245,158,11,.20));
      filter: blur(10px);
      z-index:-1;
    }
    body[data-bg="night"] .cert{
      background:
        radial-gradient(1000px 500px at 15% 0%, rgba(54,194,255,.18), transparent 55%),
        radial-gradient(1000px 500px at 85% 0%, rgba(46,231,200,.12), transparent 55%),
        radial-gradient(900px 520px at 50% 110%, rgba(245,158,11,.10), transparent 55%),
        rgba(12,22,35,.70);
    }
    .sparkles{
      position:absolute; inset:0;
      pointer-events:none;
      opacity:.55;
      background-image:
        radial-gradient(circle at 18% 22%, rgba(255,255,255,.95) 0 2px, transparent 3px),
        radial-gradient(circle at 34% 18%, rgba(255,255,255,.85) 0 1.5px, transparent 3px),
        radial-gradient(circle at 62% 12%, rgba(255,255,255,.9) 0 2px, transparent 3px),
        radial-gradient(circle at 81% 26%, rgba(255,255,255,.8) 0 1.6px, transparent 3px),
        radial-gradient(circle at 22% 76%, rgba(255,255,255,.85) 0 1.8px, transparent 3px),
        radial-gradient(circle at 72% 78%, rgba(255,255,255,.9) 0 2px, transparent 3px);
    }
    .seal{
      position:absolute;
      right:16px; bottom:16px;
      width:110px; height:110px;
      border-radius:50%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.45), transparent 55%),
              linear-gradient(135deg, rgba(45,124,247,.95), rgba(20,184,166,.92));
      border:3px solid rgba(255,255,255,.55);
      box-shadow: 0 18px 30px rgba(0,0,0,.18);
      display:flex;align-items:center;justify-content:center;
      color:#fff;
      font-weight:1000;
      text-align:center;
      padding:10px;
      transform: rotate(-6deg);
    }
    .certFairy{
      display:flex;gap:12px;align-items:center;flex-wrap:wrap;
      margin-top:12px;
    }
    .certFairy img{
      width:96px;height:96px;object-fit:contain;
      filter: drop-shadow(0 14px 20px rgba(0,0,0,.18));
    }

    /* Toast */
    .toast{
      position:fixed;
      left:50%;transform:translateX(-50%);
      bottom:14px;
      background:rgba(0,0,0,.72);
      color:#fff;
      padding:10px 12px;
      border-radius:14px;
      font-weight:900;
      display:none;
      max-width:min(820px, 92vw);
      z-index:60;
    }

    /* Print: certificate only */
    @media print{
      body{background:#fff}
      .topbar,.hero,.panel,.footer,.toast,.row button,#btnPrint,#btnSpeakCert{display:none !important}
      .wrap{padding:0;margin:0;max-width:none}
      .certWrap{display:block !important}
      .cert{box-shadow:none}
    }
  </style>
</head>

<body data-bg="meadow">
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <img class="emblem" src="assets/emblem.png" alt="–≠–º–±–ª–µ–º–∞ –ø—Ä–æ–µ–∫—Ç–∞" onerror="this.style.display='none'">
        <div>
          <h1 id="brandTitle">–ß–µ—Ä–µ–ø–∞—à–∏–π —É–≥–æ–ª–æ–∫</h1>
          <small id="brandSub">–•—Ä–∞–Ω–∏—Ç–µ–ª–∏ –ö—Ä–∞—Å–Ω–æ–π –∫–Ω–∏–≥–∏</small>
        </div>
      </div>

      <div class="controls">
        <div class="pill" aria-label="–Ø–∑—ã–∫">
          <button class="btn small" data-lang="ru">RU</button>
          <button class="btn small" data-lang="kz">KZ</button>
          <button class="btn small" data-lang="en">EN</button>
        </div>
        <div class="pill" aria-label="–§–æ–Ω">
          <button class="btn small" data-bg="meadow">–õ—É–≥</button>
          <button class="btn small" data-bg="lake">–û–∑–µ—Ä–æ</button>
          <button class="btn small" data-bg="steppe">–°—Ç–µ–ø—å</button>
          <button class="btn small" data-bg="night">–ù–æ—á—å</button>
        </div>
        <a class="btn ghost" href="index.html" id="toHome">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
      </div>
    </div>

    <section class="hero">
      <h2 id="pageTitle">–ó–∞–¥–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–π</h2>
      <p id="pageLead">–í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ–¥—Ö–æ–¥–∏—Ç 1‚Äì11 –∫–ª–∞—Å—Å–∞–º). –í—ã–ø–æ–ª–Ω—è–π –º–∏—Å—Å–∏–∏, –Ω–∞–±–∏—Ä–∞–π –±–∞–ª–ª—ã –∏ –ø–æ–ª—É—á–∞–π —Å–∫–∞–∑–æ—á–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç!</p>

      <div style="display:flex;gap:14px;justify-content:center;align-items:center;flex-wrap:wrap;margin:10px 0 2px">
        <img src="assets/fairy.png" alt="–§–µ—è –ß–µ—Ä–µ–ø–∞—à—å–µ–≥–æ —É–≥–æ–ª–∫–∞"
             style="width:120px;height:120px;object-fit:contain;filter:drop-shadow(0 14px 20px rgba(0,0,0,.18));"
             onerror="this.style.display='none'">
        <div style="max-width:760px">
          <div id="fairyHello" style="font-weight:1000;font-size:16px;color:var(--text)"></div>
          <div id="fairyTip" style="margin-top:4px;color:var(--muted);font-weight:800"></div>
        </div>
      </div>

      <div class="row">
        <button class="btn teal" id="btnSpeakHello">üîä –û–∑–≤—É—á–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ</button>
        <button class="btn" id="btnStop">‚èπ –°—Ç–æ–ø</button>
      </div>

      <div class="statRow">
        <div class="stat"><b id="stNameH">–£—á–∞—Å—Ç–Ω–∏–∫</b><span id="stName">‚Äî</span></div>
        <div class="stat"><b id="stTimeH">–í—Ä–µ–º—è</b><span id="stTime">30:00</span></div>
        <div class="stat"><b id="stScoreH">–ë–∞–ª–ª—ã</b><span id="stScore">0</span></div>
        <div class="stat"><b id="stLevelH">–£—Ä–æ–≤–µ–Ω—å</b><span id="stLevel">‚Äî</span></div>
      </div>
    </section>

    <section class="panel" aria-label="–°—Ç–∞—Ä—Ç">
      <div class="panelHead">
        <h3 id="startTitle">–°—Ç–∞—Ä—Ç –º–∏—Å—Å–∏–∏</h3>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn primary" id="btnStart">‚ñ∂ –°—Ç–∞—Ä—Ç (30 –º–∏–Ω—É—Ç)</button>
          <button class="btn" id="btnReset">‚Üª –°–±—Ä–æ—Å</button>
          <button class="btn amber" id="btnCheck">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</button>
        </div>
      </div>
      <div class="panelBody">
        <div class="form">
          <input id="studentName" type="text" placeholder="–í–≤–µ–¥–∏ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ê–π–¥–∞–Ω–∞ –°.)" autocomplete="off">
        </div>
        <div class="hint" id="startHint">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞–Ω–∏—è –≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ, –Ω–æ –≤—ã–±–µ—Ä–∏ –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π.</div>
      </div>
    </section>

    <section class="panel" aria-label="–ó–∞–¥–∞–Ω–∏—è">
      <div class="panelHead">
        <h3 id="taskTitle">–ù–∞–±–æ—Ä –∑–∞–¥–∞–Ω–∏–π (—É—Ä–æ–≤–Ω–∏ –≤–Ω—É—Ç—Ä–∏)</h3>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn" id="btnSetL1">–£—Ä–æ–≤–µ–Ω—å 1</button>
          <button class="btn" id="btnSetL2">–£—Ä–æ–≤–µ–Ω—å 2</button>
          <button class="btn" id="btnSetL3">–£—Ä–æ–≤–µ–Ω—å 3</button>
        </div>
      </div>

      <div class="panelBody">
        <div class="levels">
          <details class="level" id="lvl1" open>
            <summary>
              <span id="lvl1Title">–£—Ä–æ–≤–µ–Ω—å 1 (1‚Äì4 –∫–ª–∞—Å—Å—ã)</span>
              <span class="badge" id="lvl1Pts">5 –±–∞–ª–ª–æ–≤ –∑–∞ –≤–æ–ø—Ä–æ—Å</span>
            </summary>
            <div id="l1Box"></div>
          </details>

          <details class="level" id="lvl2">
            <summary>
              <span id="lvl2Title">–£—Ä–æ–≤–µ–Ω—å 2 (5‚Äì7 –∫–ª–∞—Å—Å—ã)</span>
              <span class="badge" id="lvl2Pts">7 –±–∞–ª–ª–æ–≤ –∑–∞ –≤–æ–ø—Ä–æ—Å</span>
            </summary>
            <div id="l2Box"></div>
          </details>

          <details class="level" id="lvl3">
            <summary>
              <span id="lvl3Title">–£—Ä–æ–≤–µ–Ω—å 3 (8‚Äì11 –∫–ª–∞—Å—Å—ã)</span>
              <span class="badge" id="lvl3Pts">10 –±–∞–ª–ª–æ–≤ –∑–∞ –≤–æ–ø—Ä–æ—Å</span>
            </summary>
            <div id="l3Box"></div>
          </details>
        </div>

        <div class="divider"></div>

        <div class="mini">
          <div class="box">
            <h4 id="situTitle">–ú–∏–Ω–∏-–º–∏—Å—Å–∏—è ¬´–°–∏—Ç—É–∞—Ü–∏–∏¬ª (–¥–æ–ø. –±–∞–ª–ª—ã)</h4>
            <ul class="list" id="situList"></ul>
            <div class="hint" id="situHint">–ù–∞–ø–∏—à–∏ –æ—Ç–≤–µ—Ç—ã –∫–æ—Ä–æ—Ç–∫–æ (3‚Äì5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π). –ó–∞ –∫–∞–∂–¥—É—é —Å–∏—Ç—É–∞—Ü–∏—é +5 –±–∞–ª–ª–æ–≤ (—É—á–∏—Ç–µ–ª—å –æ—Ü–µ–Ω–∏—Ç).</div>
          </div>
          <div class="box">
            <h4 id="noteTitle">–ó–∞–º–µ—Ç–∫–∏ –•—Ä–∞–Ω–∏—Ç–µ–ª—è</h4>
            <textarea id="notes" rows="11" style="width:100%;border:1px solid var(--stroke);border-radius:14px;padding:10px;font-weight:800;color:var(--text);background:rgba(255,255,255,.78);outline:none"
              placeholder="–ü–∏—à–∏ –∑–¥–µ—Å—å —Å–≤–æ–∏ –∏–¥–µ–∏: –ø—Ä–∞–≤–∏–ª–∞, –ª–æ–∑—É–Ω–≥–∏, –ø–ª–∞–Ω QR-—Å—Ç–µ–Ω–¥–∞..."></textarea>
            <div class="hint" id="noteHint">–°–æ–≤–µ—Ç: –ø—Ä–∏–¥—É–º–∞–π 1 –ø—Ä–∞–≤–∏–ª–æ-—Å–ª–æ–≥–∞–Ω –ø—Ä–æ —á–µ—Ä–µ–ø–∞—Ö—É. –û–Ω–æ –¥–æ–ª–∂–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç –ø—Ä–∏–º–µ—Ä–æ–≤.</div>
          </div>
        </div>

        <div class="row" style="margin-top:14px">
          <button class="btn teal" id="btnSpeakRules">üîä –û–∑–≤—É—á–∏—Ç—å ¬´–ü—Ä–∞–≤–∏–ª–∞ –•—Ä–∞–Ω–∏—Ç–µ–ª—è¬ª</button>
          <button class="btn" id="btnStop2">‚èπ –°—Ç–æ–ø</button>
        </div>

        <div class="hint" id="uniqHint">
          –í–∞–∂–Ω–æ: —á—Ç–æ–±—ã —Ä–∏—Å—É–Ω–∫–∏/–∏–¥–µ–∏ –æ—Ç–ª–∏—á–∞–ª–∏—Å—å –æ—Ç –ø—Ä–∏–º–µ—Ä–∞ ‚Äî –¥–æ–±–∞–≤—å 3 —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ (–∑–Ω–∞—á–æ–∫, —Ü–≤–µ—Ç, —É–∑–æ—Ä, —Å–ª–æ–≥–∞–Ω, –¥–∞—Ç—É, –∏–º—è).
        </div>
      </div>
    </section>

    <section class="certWrap" id="certWrap" aria-label="–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç">
      <div class="cert" id="cert">
        <div class="sparkles"></div>

        <div class="certTop">
          <img src="assets/emblem.png" alt="–≠–º–±–ª–µ–º–∞" onerror="this.style.display='none'">
          <div>
            <div class="certTitle" id="certTitle">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –•—Ä–∞–Ω–∏—Ç–µ–ª—è</div>
            <div class="certSub" id="certSub">¬´–ß–µ—Ä–µ–ø–∞—à–∏–π —É–≥–æ–ª–æ–∫: —Ö—Ä–∞–Ω–∏—Ç–µ–ª–∏ –ö—Ä–∞—Å–Ω–æ–π –∫–Ω–∏–≥–∏¬ª</div>
          </div>
        </div>

        <div class="certLine" id="certLine">–ù–∞—Å—Ç–æ—è—â–∏–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ</div>
        <div class="certBig" id="certName">‚Äî</div>

        <div class="certFairy">
          <img src="assets/fairy.png" alt="–§–µ—è" onerror="this.style.display='none'">
          <div style="flex:1;min-width:240px">
            <div style="font-weight:1000" id="certFairyLine"></div>
            <div style="margin-top:4px;color:var(--muted);font-weight:900" id="certFairyLine2"></div>
          </div>
        </div>

        <div class="certMeta">
          <div class="chip" id="certScore">–ë–∞–ª–ª—ã: 0</div>
          <div class="chip" id="certLevel">–£—Ä–æ–≤–µ–Ω—å: ‚Äî</div>
          <div class="chip" id="certTime">–í—Ä–µ–º—è: 00:00</div>
          <div class="chip" id="certDate">–î–∞—Ç–∞: ‚Äî</div>
        </div>

        <div class="seal" id="sealText">–•–†–ê–ù–ò–¢–ï–õ–¨<br>–ö–†–ê–°–ù–û–ô –ö–ù–ò–ì–ò</div>
      </div>

      <div class="row" style="margin-top:12px">
        <button class="btn primary" id="btnPrint">üñ® –ü–µ—á–∞—Ç—å/–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF</button>
        <button class="btn teal" id="btnSpeakCert">üîä –û–∑–≤—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</button>
      </div>
    </section>

    <div class="footer" id="credits">
      ¬© –≠–∫–æ-–ø—Ä–æ–µ–∫—Ç ¬´–ß–µ—Ä–µ–ø–∞—à–∏–π —É–≥–æ–ª–æ–∫: —Ö—Ä–∞–Ω–∏—Ç–µ–ª–∏ –ö—Ä–∞—Å–Ω–æ–π –∫–Ω–∏–≥–∏¬ª.
      –ö–ì–£ ¬´–û–±—â–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —à–∫–æ–ª–∞ ‚Ññ 1¬ª –æ—Ç–¥–µ–ª–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≥–æ—Ä–æ–¥–∞ –ë–∞–ª—Ö–∞—à —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ö–∞—Ä–∞–≥–∞–Ω–¥–∏–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏,
      —É—á–∞—â–∏–µ—Å—è 7 ¬´–ë¬ª –∫–ª–∞—Å—Å–∞.
    </div>
  </div>

  <div class="toast" id="toast"></div>

<script>
const LS_LANG = "eco_lang";
const LS_BG   = "eco_bg";

const $ = (s)=>document.querySelector(s);
const $$ = (s)=>Array.from(document.querySelectorAll(s));
function toast(msg){
  const t = $("#toast");
  t.textContent = msg;
  t.style.display="block";
  clearTimeout(toast._t);
  toast._t = setTimeout(()=>t.style.display="none", 2600);
}

const I18N = {
  ru:{
    brandTitle:"–ß–µ—Ä–µ–ø–∞—à–∏–π —É–≥–æ–ª–æ–∫",
    brandSub:"–•—Ä–∞–Ω–∏—Ç–µ–ª–∏ –ö—Ä–∞—Å–Ω–æ–π –∫–Ω–∏–≥–∏",
    toHome:"‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é",
    pageTitle:"–ó–∞–¥–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–π",
    pageLead:"–í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ–¥—Ö–æ–¥–∏—Ç 1‚Äì11 –∫–ª–∞—Å—Å–∞–º). –í—ã–ø–æ–ª–Ω—è–π –º–∏—Å—Å–∏–∏, –Ω–∞–±–∏—Ä–∞–π –±–∞–ª–ª—ã –∏ –ø–æ–ª—É—á–∞–π —Å–∫–∞–∑–æ—á–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç!",
    startTitle:"–°—Ç–∞—Ä—Ç –º–∏—Å—Å–∏–∏",
    startBtn:"‚ñ∂ –°—Ç–∞—Ä—Ç (30 –º–∏–Ω—É—Ç)",
    resetBtn:"‚Üª –°–±—Ä–æ—Å",
    checkBtn:"‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç",
    startHint:"–ü–æ–¥—Å–∫–∞–∑–∫–∞: –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞–Ω–∏—è –≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ, –Ω–æ –≤—ã–±–µ—Ä–∏ –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π.",
    taskTitle:"–ù–∞–±–æ—Ä –∑–∞–¥–∞–Ω–∏–π (—É—Ä–æ–≤–Ω–∏ –≤–Ω—É—Ç—Ä–∏)",
    lvl1Title:"–£—Ä–æ–≤–µ–Ω—å 1 (1‚Äì4 –∫–ª–∞—Å—Å—ã)",
    lvl2Title:"–£—Ä–æ–≤–µ–Ω—å 2 (5‚Äì7 –∫–ª–∞—Å—Å—ã)",
    lvl3Title:"–£—Ä–æ–≤–µ–Ω—å 3 (8‚Äì11 –∫–ª–∞—Å—Å—ã)",
    lvl1Pts:"5 –±–∞–ª–ª–æ–≤ –∑–∞ –≤–æ–ø—Ä–æ—Å",
    lvl2Pts:"7 –±–∞–ª–ª–æ–≤ –∑–∞ –≤–æ–ø—Ä–æ—Å",
    lvl3Pts:"10 –±–∞–ª–ª–æ–≤ –∑–∞ –≤–æ–ø—Ä–æ—Å",
    situTitle:"–ú–∏–Ω–∏-–º–∏—Å—Å–∏—è ¬´–°–∏—Ç—É–∞—Ü–∏–∏¬ª (–¥–æ–ø. –±–∞–ª–ª—ã)",
    situHint:"–ù–∞–ø–∏—à–∏ –æ—Ç–≤–µ—Ç—ã –∫–æ—Ä–æ—Ç–∫–æ (3‚Äì5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π). –ó–∞ –∫–∞–∂–¥—É—é —Å–∏—Ç—É–∞—Ü–∏—é +5 –±–∞–ª–ª–æ–≤ (—É—á–∏—Ç–µ–ª—å –æ—Ü–µ–Ω–∏—Ç).",
    noteTitle:"–ó–∞–º–µ—Ç–∫–∏ –•—Ä–∞–Ω–∏—Ç–µ–ª—è",
    noteHint:"–°–æ–≤–µ—Ç: –ø—Ä–∏–¥—É–º–∞–π 1 –ø—Ä–∞–≤–∏–ª–æ-—Å–ª–æ–≥–∞–Ω –ø—Ä–æ —á–µ—Ä–µ–ø–∞—Ö—É. –û–Ω–æ –¥–æ–ª–∂–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç –ø—Ä–∏–º–µ—Ä–æ–≤.",
    uniqHint:"–í–∞–∂–Ω–æ: —á—Ç–æ–±—ã –∏–¥–µ–∏ –æ—Ç–ª–∏—á–∞–ª–∏—Å—å –æ—Ç –ø—Ä–∏–º–µ—Ä–∞ ‚Äî –¥–æ–±–∞–≤—å 3 —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ (–∑–Ω–∞—á–æ–∫, —Ü–≤–µ—Ç, —É–∑–æ—Ä, —Å–ª–æ–≥–∞–Ω, –¥–∞—Ç—É, –∏–º—è).",
    stNameH:"–£—á–∞—Å—Ç–Ω–∏–∫",
    stTimeH:"–í—Ä–µ–º—è",
    stScoreH:"–ë–∞–ª–ª—ã",
    stLevelH:"–£—Ä–æ–≤–µ–Ω—å",
    speakHello:"üîä –û–∑–≤—É—á–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ",
    speakRules:"üîä –û–∑–≤—É—á–∏—Ç—å ¬´–ü—Ä–∞–≤–∏–ª–∞ –•—Ä–∞–Ω–∏—Ç–µ–ª—è¬ª",
    stop:"‚èπ –°—Ç–æ–ø",
    l1Btn:"–£—Ä–æ–≤–µ–Ω—å 1",
    l2Btn:"–£—Ä–æ–≤–µ–Ω—å 2",
    l3Btn:"–£—Ä–æ–≤–µ–Ω—å 3",
    certTitle:"–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –•—Ä–∞–Ω–∏—Ç–µ–ª—è",
    certSub:"¬´–ß–µ—Ä–µ–ø–∞—à–∏–π —É–≥–æ–ª–æ–∫: —Ö—Ä–∞–Ω–∏—Ç–µ–ª–∏ –ö—Ä–∞—Å–Ω–æ–π –∫–Ω–∏–≥–∏¬ª",
    certLine:"–ù–∞—Å—Ç–æ—è—â–∏–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ",
    certPrint:"üñ® –ü–µ—á–∞—Ç—å/–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ PDF",
    certSpeak:"üîä –û–∑–≤—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç",
    fairyHello:"–§–µ—è ¬´–ß–µ—Ä–µ–ø–∞—à—å–µ–≥–æ —É–≥–æ–ª–∫–∞¬ª –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–±—è, –•—Ä–∞–Ω–∏—Ç–µ–ª—å!",
    fairyTip:"–¢–≤–æ—è –º–∏—Å—Å–∏—è: —Å–ø–∞—Å—Ç–∏ –ß–µ—Ä–µ–ø–∞—Ö—É –∏ –µ—ë –¥—Ä—É–∑–µ–π ‚Äî –≤—ã–ø–æ–ª–Ω—è–π –∑–∞–¥–∞–Ω–∏—è –∏ —Å–æ–∑–¥–∞–π —Å–≤–æ–π –∑–Ω–∞–∫ —Ö—Ä–∞–Ω–∏—Ç–µ–ª—è.",
    certFairyLine:"–§–µ—è –ö—Ä–∞—Å–Ω–æ–∫–Ω–∏–∂–Ω–∏—Ü–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç: –º–∏—Å—Å–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞!",
    certFairyLine2:"–ë–µ—Ä–µ–≥–∏ –ø—Ä–∏—Ä–æ–¥—É: –Ω–µ –∑–∞–±–∏—Ä–∞–π –∂–∏–≤–æ—Ç–Ω—ã—Ö –¥–æ–º–æ–π, –Ω–µ —Ä–≤–∏ —Ä–µ–¥–∫–∏–µ —Ü–≤–µ—Ç—ã, –Ω–µ –æ—Å—Ç–∞–≤–ª—è–π –º—É—Å–æ—Ä."
  },
  kz:{
    brandTitle:"–¢–∞—Å–±–∞“õ–∞ –±“±—Ä—ã—à—ã",
    brandSub:"“ö—ã–∑—ã–ª –∫—ñ—Ç–∞–ø —Å–∞“õ—à—ã–ª–∞—Ä—ã",
    toHome:"‚Üê –ë–∞—Å—Ç—ã –±–µ—Ç–∫–µ",
    pageTitle:"–°–∞“õ—à—ã–ª–∞—Ä —Ç–∞–ø—Å—ã—Ä–º–∞–ª–∞—Ä—ã",
    pageLead:"–ë–µ—Ç—Ç—ñ“£ —ñ—à—ñ–Ω–¥–µ –¥–µ“£–≥–µ–π–¥—ñ —Ç–∞“£–¥–∞ (1‚Äì11 —Å—ã–Ω—ã–ø). –ú–∏—Å—Å–∏—è–ª–∞—Ä–¥—ã –æ—Ä—ã–Ω–¥–∞–ø, “±–ø–∞–π –∂–∏–Ω–∞–ø, –µ—Ä—Ç–µ–≥—ñ–¥–µ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∞–ª!",
    startTitle:"–ú–∏—Å—Å–∏—è–Ω—ã –±–∞—Å—Ç–∞—É",
    startBtn:"‚ñ∂ –ë–∞—Å—Ç–∞—É (30 –º–∏–Ω—É—Ç)",
    resetBtn:"‚Üª “ö–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É",
    checkBtn:"‚úÖ –¢–µ–∫—Å–µ—Ä—É –∂”ô–Ω–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∞–ª—É",
    startHint:"–ö–µ“£–µ—Å: —Ç–∞–ø—Å—ã—Ä–º–∞–ª–∞—Ä–¥—ã –∫–µ–∑ –∫–µ–ª–≥–µ–Ω —Ä–µ—Ç–ø–µ–Ω –æ—Ä—ã–Ω–¥–∞, –±—ñ—Ä–∞“õ –±—ñ—Ä –¥–µ“£–≥–µ–π–¥—ñ –Ω–µ–≥—ñ–∑–≥—ñ —Ä–µ—Ç—ñ–Ω–¥–µ —Ç–∞“£–¥–∞.",
    taskTitle:"–¢–∞–ø—Å—ã—Ä–º–∞–ª–∞—Ä –∂–∏—ã–Ω—ã (–¥–µ“£–≥–µ–π–ª–µ—Ä —ñ—à—ñ–Ω–¥–µ)",
    lvl1Title:"–î–µ“£–≥–µ–π 1 (1‚Äì4 —Å—ã–Ω—ã–ø)",
    lvl2Title:"–î–µ“£–≥–µ–π 2 (5‚Äì7 —Å—ã–Ω—ã–ø)",
    lvl3Title:"–î–µ“£–≥–µ–π 3 (8‚Äì11 —Å—ã–Ω—ã–ø)",
    lvl1Pts:"”ò—Ä —Å“±—Ä–∞“õ“õ–∞ 5 “±–ø–∞–π",
    lvl2Pts:"”ò—Ä —Å“±—Ä–∞“õ“õ–∞ 7 “±–ø–∞–π",
    lvl3Pts:"”ò—Ä —Å“±—Ä–∞“õ“õ–∞ 10 “±–ø–∞–π",
    situTitle:"–ú–∏–Ω–∏-–º–∏—Å—Å–∏—è ¬´–ñ–∞“ì–¥–∞–π–ª–∞—Ä¬ª (“õ–æ—Å—ã–º—à–∞ “±–ø–∞–π)",
    situHint:"–ñ–∞—É–∞–ø—Ç—ã “õ—ã—Å“õ–∞ –∂–∞–∑ (3‚Äì5 —Å”©–π–ª–µ–º). ”ò—Ä –∂–∞“ì–¥–∞–π“ì–∞ +5 “±–ø–∞–π (–º“±“ì–∞–ª—ñ–º –±–∞“ì–∞–ª–∞–π–¥—ã).",
    noteTitle:"–°–∞“õ—à—ã–Ω—ã“£ –∂–∞–∑–±–∞–ª–∞—Ä—ã",
    noteHint:"–ö–µ“£–µ—Å: —Ç–∞—Å–±–∞“õ–∞ —Ç—É—Ä–∞–ª—ã 1 “±—Ä–∞–Ω –æ–π–ª–∞–ø —Ç–∞–ø. –û–ª “Ø–ª–≥—ñ–¥–µ–Ω ”©–∑–≥–µ—à–µ –±–æ–ª—Å—ã–Ω.",
    uniqHint:"–ú–∞“£—ã–∑–¥—ã: “Ø–ª–≥—ñ–¥–µ–Ω –∞–π—ã—Ä–º–∞—à—ã–ª—ã“ì—ã –±–æ–ª—É “Ø—à—ñ–Ω 3 –µ—Ä–µ–∫—à–µ –¥–µ—Ç–∞–ª—å “õ–æ—Å (–±–µ–ª–≥—ñ, —Ç“Ø—Å, ”©—Ä–Ω–µ–∫, “±—Ä–∞–Ω, –∫“Ø–Ω, –∞—Ç—ã).",
    stNameH:"“ö–∞—Ç—ã—Å—É—à—ã",
    stTimeH:"–£–∞“õ—ã—Ç",
    stScoreH:"“∞–ø–∞–π",
    stLevelH:"–î–µ“£–≥–µ–π",
    speakHello:"üîä –°”ô–ª–µ–º–¥–µ—Å—É–¥—ñ –¥—ã–±—ã—Å—Ç–∞—É",
    speakRules:"üîä ¬´–°–∞“õ—à—ã –µ—Ä–µ–∂–µ–ª–µ—Ä—ñ¬ª –¥—ã–±—ã—Å—Ç–∞—É",
    stop:"‚èπ –¢–æ“õ—Ç–∞—Ç—É",
    l1Btn:"–î–µ“£–≥–µ–π 1",
    l2Btn:"–î–µ“£–≥–µ–π 2",
    l3Btn:"–î–µ“£–≥–µ–π 3",
    certTitle:"–°–∞“õ—à—ã —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã",
    certSub:"¬´–¢–∞—Å–±–∞“õ–∞ –±“±—Ä—ã—à—ã: “ö—ã–∑—ã–ª –∫—ñ—Ç–∞–ø —Å–∞“õ—à—ã–ª–∞—Ä—ã¬ª",
    certLine:"–û—Å—ã –∞—Ä“õ—ã–ª—ã —Ä–∞—Å—Ç–∞–ª–∞–¥—ã:",
    certPrint:"üñ® –ë–∞—Å—ã–ø —à—ã“ì–∞—Ä—É/PDF",
    certSpeak:"üîä –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—Ç—ã –¥—ã–±—ã—Å—Ç–∞—É",
    fairyHello:"¬´–¢–∞—Å–±–∞“õ–∞ –±“±—Ä—ã—à—ã–Ω—ã“£¬ª –§–µ—è—Å—ã —Å–µ–Ω—ñ “õ–∞—Ä—Å—ã –∞–ª–∞–¥—ã, –°–∞“õ—à—ã!",
    fairyTip:"–ú–∏—Å—Å–∏—è“£: –¢–∞—Å–±–∞“õ–∞ –º–µ–Ω –¥–æ—Å—Ç–∞—Ä—ã–Ω “õ–æ—Ä“ì–∞—É ‚Äî —Ç–∞–ø—Å—ã—Ä–º–∞–ª–∞—Ä–¥—ã –æ—Ä—ã–Ω–¥–∞–ø, –±–µ–ª–≥—ñ“£–¥—ñ –∂–∞—Å–∞.",
    certFairyLine:"“ö—ã–∑—ã–ª –∫—ñ—Ç–∞–ø –§–µ—è—Å—ã —Ä–∞—Å—Ç–∞–π–¥—ã: –º–∏—Å—Å–∏—è –æ—Ä—ã–Ω–¥–∞–ª–¥—ã!",
    certFairyLine2:"–¢–∞–±–∏“ì–∞—Ç—Ç—ã —Å–∞“õ—Ç–∞: –∂–∞–Ω—É–∞—Ä–¥—ã “Ø–π–≥–µ ”ô–∫–µ–ª–º–µ, —Å–∏—Ä–µ–∫ –≥“Ø–ª–¥—ñ –∂“±–ª–º–∞, “õ–æ“õ—ã—Å “õ–∞–ª–¥—ã—Ä–º–∞."
  },
  en:{
    brandTitle:"Turtle Corner",
    brandSub:"Red Book Guardians",
    toHome:"‚Üê Home",
    pageTitle:"Guardian Tasks",
    pageLead:"Choose a level inside the page (grades 1‚Äì11). Complete missions, earn points, and get a fairy certificate!",
    startTitle:"Start mission",
    startBtn:"‚ñ∂ Start (30 minutes)",
    resetBtn:"‚Üª Reset",
    checkBtn:"‚úÖ Check and get certificate",
    startHint:"Tip: you can do tasks in any order, but pick one main level.",
    taskTitle:"Task set (levels inside)",
    lvl1Title:"Level 1 (grades 1‚Äì4)",
    lvl2Title:"Level 2 (grades 5‚Äì7)",
    lvl3Title:"Level 3 (grades 8‚Äì11)",
    lvl1Pts:"5 points per question",
    lvl2Pts:"7 points per question",
    lvl3Pts:"10 points per question",
    situTitle:"Mini-mission ‚ÄúSituations‚Äù (bonus)",
    situHint:"Write short answers (3‚Äì5 sentences). +5 points each (teacher checks).",
    noteTitle:"Guardian Notes",
    noteHint:"Tip: create 1 turtle slogan different from examples.",
    uniqHint:"Important: make your work different‚Äîadd 3 unique details (symbol, color, pattern, slogan, date, name).",
    stNameH:"Student",
    stTimeH:"Time",
    stScoreH:"Score",
    stLevelH:"Level",
    speakHello:"üîä Speak greeting",
    speakRules:"üîä Speak ‚ÄúGuardian rules‚Äù",
    stop:"‚èπ Stop",
    l1Btn:"Level 1",
    l2Btn:"Level 2",
    l3Btn:"Level 3",
    certTitle:"Guardian Certificate",
    certSub:"‚ÄúTurtle Corner: Red Book Guardians‚Äù",
    certLine:"This certifies that",
    certPrint:"üñ® Print/Save PDF",
    certSpeak:"üîä Speak certificate",
    fairyHello:"The Fairy of the Turtle Corner welcomes you, Guardian!",
    fairyTip:"Your mission: protect the Tortoise and friends‚Äîcomplete tasks and create your emblem.",
    certFairyLine:"The Red Book Fairy confirms: mission completed!",
    certFairyLine2:"Protect nature: don‚Äôt take wildlife home, don‚Äôt pick rare flowers, don‚Äôt litter."
  }
};

let lang = localStorage.getItem(LS_LANG) || "ru";
let bg   = localStorage.getItem(LS_BG)   || "meadow";
document.body.dataset.bg = bg;

function t(key){ return (I18N[lang] && I18N[lang][key]) ? I18N[lang][key] : I18N.ru[key]; }
function applyActiveButtons(){
  $$("[data-lang]").forEach(b=>b.classList.toggle("active", b.dataset.lang===lang));
  $$("[data-bg]").forEach(b=>b.classList.toggle("active", b.dataset.bg===bg));
}
function setStaticText(){
  $("#brandTitle").textContent = t("brandTitle");
  $("#brandSub").textContent = t("brandSub");
  $("#toHome").textContent = t("toHome");

  $("#pageTitle").textContent = t("pageTitle");
  $("#pageLead").textContent  = t("pageLead");

  $("#startTitle").textContent = t("startTitle");
  $("#btnStart").textContent   = t("startBtn");
  $("#btnReset").textContent   = t("resetBtn");
  $("#btnCheck").textContent   = t("checkBtn");
  $("#startHint").textContent  = t("startHint");

  $("#taskTitle").textContent  = t("taskTitle");
  $("#lvl1Title").textContent  = t("lvl1Title");
  $("#lvl2Title").textContent  = t("lvl2Title");
  $("#lvl3Title").textContent  = t("lvl3Title");
  $("#lvl1Pts").textContent    = t("lvl1Pts");
  $("#lvl2Pts").textContent    = t("lvl2Pts");
  $("#lvl3Pts").textContent    = t("lvl3Pts");

  $("#situTitle").textContent = t("situTitle");
  $("#situHint").textContent  = t("situHint");
  $("#noteTitle").textContent = t("noteTitle");
  $("#noteHint").textContent  = t("noteHint");
  $("#uniqHint").textContent  = t("uniqHint");

  $("#stNameH").textContent  = t("stNameH");
  $("#stTimeH").textContent  = t("stTimeH");
  $("#stScoreH").textContent = t("stScoreH");
  $("#stLevelH").textContent = t("stLevelH");

  $("#btnSpeakHello").textContent = t("speakHello");
  $("#btnSpeakRules").textContent = t("speakRules");
  $("#btnStop").textContent = t("stop");
  $("#btnStop2").textContent = t("stop");

  $("#btnSetL1").textContent = t("l1Btn");
  $("#btnSetL2").textContent = t("l2Btn");
  $("#btnSetL3").textContent = t("l3Btn");

  $("#certTitle").textContent = t("certTitle");
  $("#certSub").textContent   = t("certSub");
  $("#certLine").textContent  = t("certLine");
  $("#btnPrint").textContent  = t("certPrint");
  $("#btnSpeakCert").textContent = t("certSpeak");

  $("#fairyHello").textContent = t("fairyHello");
  $("#fairyTip").textContent   = t("fairyTip");
  $("#certFairyLine").textContent  = t("certFairyLine");
  $("#certFairyLine2").textContent = t("certFairyLine2");
}

const QUIZ = {
  l1: [
    {q:{ru:"–ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –∑–∞–±–∏—Ä–∞—Ç—å —á–µ—Ä–µ–ø–∞—Ö—É –∏–∑ –ø—Ä–∏—Ä–æ–¥—ã –¥–æ–º–æ–π?",kz:"–ù–µ–≥–µ —Ç–∞—Å–±–∞“õ–∞–Ω—ã —Ç–∞–±–∏“ì–∞—Ç—Ç–∞–Ω “Ø–π–≥–µ ”ô–∫–µ–ª—É–≥–µ –±–æ–ª–º–∞–π–¥—ã?",en:"Why shouldn‚Äôt we take a tortoise from the wild?"},
     a:[
      {t:{ru:"–û–Ω–∞ —Ç–µ—Ä—è–µ—Ç –¥–æ–º –∏ –ø–æ–ø—É–ª—è—Ü–∏—è —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è",kz:"“Æ–π—ñ–Ω –∂–æ“ì–∞–ª—Ç–∞–¥—ã, —Å–∞–Ω—ã –∞–∑–∞—è–¥—ã",en:"It loses its home and populations decline"}, ok:true},
      {t:{ru:"–¢–∞–∫ —É–¥–æ–±–Ω–µ–µ –Ω–∞–±–ª—é–¥–∞—Ç—å",kz:"–ë–∞“õ—ã–ª–∞—É –æ“£–∞–π",en:"It‚Äôs easier to watch"}, ok:false},
      {t:{ru:"–¢–∞–∫ –¥–µ–ª–∞—é—Ç –≤—Å–µ",kz:"–ë”ô—Ä—ñ —Å–æ–ª–∞–π",en:"Everyone does it"}, ok:false},
     ], pts:5},
    {q:{ru:"–ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å –º—É—Å–æ—Ä–æ–º –ø–æ—Å–ª–µ –ø–∏–∫–Ω–∏–∫–∞?",kz:"–ü–∏–∫–Ω–∏–∫—Ç–µ–Ω –∫–µ–π—ñ–Ω “õ–æ“õ—ã—Å–ø–µ–Ω –Ω–µ —ñ—Å—Ç–µ—É –∫–µ—Ä–µ–∫?",en:"What to do with trash after a picnic?"},
     a:[
      {t:{ru:"–ó–∞–±—Ä–∞—Ç—å —Å —Å–æ–±–æ–π –∏ –≤—ã–±—Ä–æ—Å–∏—Ç—å –≤ —É—Ä–Ω—É",kz:"”®–∑—ñ“£–º–µ–Ω –∞–ª—ã–ø –∫–µ—Ç—ñ–ø, –∂”ô—à—ñ–∫–∫–µ —Ç–∞—Å—Ç–∞—É",en:"Take it with you and bin it"}, ok:true},
      {t:{ru:"–û—Å—Ç–∞–≤–∏—Ç—å –ø–æ–¥ –∫—É—Å—Ç–æ–º",kz:"–ë“±—Ç–∞ –∞—Å—Ç—ã–Ω–∞ “õ–∞–ª–¥—ã—Ä—É",en:"Leave under a bush"}, ok:false},
      {t:{ru:"–°–∂–µ—á—å –ø–ª–∞—Å—Ç–∏–∫",kz:"–ü–ª–∞—Å—Ç–∏–∫—Ç—ñ –∂–∞“ì—É",en:"Burn plastic"}, ok:false},
     ], pts:5},
    {q:{ru:"–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —É–≤–∏–¥–µ–ª(–∞) —á–µ—Ä–µ–ø–∞—Ö—É –≤ –ø—Ä–∏—Ä–æ–¥–µ?",kz:"–¢–∞–±–∏“ì–∞—Ç—Ç–∞ —Ç–∞—Å–±–∞“õ–∞–Ω—ã –∫”©—Ä—Å–µ“£ –Ω–µ —ñ—Å—Ç–µ–π—Å—ñ“£?",en:"What to do if you see a tortoise in nature?"},
     a:[
      {t:{ru:"–¢–∏—Ö–æ –ø–æ–Ω–∞–±–ª—é–¥–∞—Ç—å –∏ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å",kz:"–¢—ã–Ω—ã—à –±–∞“õ—ã–ª–∞–ø, —Ç–∏–º–µ—É",en:"Observe quietly, don‚Äôt touch"}, ok:true},
      {t:{ru:"–ó–∞–±—Ä–∞—Ç—å –¥–æ–º–æ–π",kz:"“Æ–π–≥–µ ”ô–∫–µ—Ç—É",en:"Take home"}, ok:false},
      {t:{ru:"–®—É–º–µ—Ç—å —Ä—è–¥–æ–º",kz:"“ö–∞—Ç—Ç—ã —à—É–ª–∞—É",en:"Make noise"}, ok:false},
     ], pts:5},
    {q:{ru:"–ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –º—É—Å–æ—Ä–∏—Ç—å —É –æ–∑–µ—Ä–∞?",kz:"–ö”©–ª–¥–µ –Ω–µ–≥–µ “õ–æ“õ—ã—Å —Ç–∞—Å—Ç–∞—É“ì–∞ –±–æ–ª–º–∞–π–¥—ã?",en:"Why not litter near a lake?"},
     a:[
      {t:{ru:"–ü—Ç–∏—Ü—ã –∏ —Ä—ã–±—ã –º–æ–≥—É—Ç –ø–æ—Å—Ç—Ä–∞–¥–∞—Ç—å",kz:"“ö“±—Å –ø–µ–Ω –±–∞–ª—ã“õ –∑–∞—Ä–¥–∞–ø —à–µ–≥–µ–¥—ñ",en:"Birds/fish can be harmed"}, ok:true},
      {t:{ru:"–¢–∞–∫ –∫—Ä–∞—Å–∏–≤–µ–µ –≤—ã–≥–ª—è–¥–∏—Ç",kz:"”ò–¥–µ–º—ñ –∫”©—Ä—ñ–Ω–µ–¥—ñ",en:"It looks nicer"}, ok:false},
      {t:{ru:"–ü–æ—Ç–æ–º—É —á—Ç–æ —Ç–∞–∫ –¥–µ–ª–∞—é—Ç –≤—Å–µ",kz:"–ë–∞—Ä–ª—ã“ì—ã —Å–æ–ª–∞–π —ñ—Å—Ç–µ–π–¥—ñ",en:"Everyone does it"}, ok:false},
     ], pts:5},
    {q:{ru:"–ö—Ä–∞—Å–Ω–∞—è –∫–Ω–∏–≥–∞ ‚Äî —ç—Ç–æ‚Ä¶",kz:"“ö—ã–∑—ã–ª –∫—ñ—Ç–∞–ø ‚Äî –±“±–ª‚Ä¶",en:"The Red Book is‚Ä¶"},
     a:[
      {t:{ru:"–°–ø–∏—Å–æ–∫ —Ä–µ–¥–∫–∏—Ö –≤–∏–¥–æ–≤ –∏ –∏—Ö –æ—Ö—Ä–∞–Ω—ã",kz:"–°–∏—Ä–µ–∫ —Ç“Ø—Ä–ª–µ—Ä —Ç—ñ–∑—ñ–º—ñ –∂”ô–Ω–µ “õ–æ—Ä“ì–∞—É",en:"A list of rare species and protection"}, ok:true},
      {t:{ru:"–ö–Ω–∏–≥–∞ —Å–∫–∞–∑–æ–∫",kz:"–ï—Ä—Ç–µ–≥—ñ –∫—ñ—Ç–∞–±—ã",en:"A fairy tale book"}, ok:false},
      {t:{ru:"–£—á–µ–±–Ω–∏–∫ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ",kz:"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –æ“õ—É–ª—ã“ì—ã",en:"A math textbook"}, ok:false},
     ], pts:5},
    {q:{ru:"–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ —à–∫–æ–ª–µ –¥–ª—è –ø—Ä–∏—Ä–æ–¥—ã?",kz:"–ú–µ–∫—Ç–µ–ø—Ç–µ —Ç–∞–±–∏“ì–∞—Ç “Ø—à—ñ–Ω –Ω–µ —ñ—Å—Ç–µ–π –∞–ª–∞—Å—ã“£?",en:"What can you do at school for nature?"},
     a:[
      {t:{ru:"–°–¥–µ–ª–∞—Ç—å –ø–ª–∞–∫–∞—Ç/QR-–ø–∞–º—è—Ç–∫—É",kz:"–ü–ª–∞–∫–∞—Ç/QR-–∂–∞–¥—ã–Ω–∞–º–∞",en:"Make a poster/QR memo"}, ok:true},
      {t:{ru:"–õ–æ–º–∞—Ç—å —Ä–∞—Å—Ç–µ–Ω–∏—è",kz:"”®—Å—ñ–º–¥—ñ–∫—Ç—ñ —Å—ã–Ω–¥—ã—Ä—É",en:"Break plants"}, ok:false},
      {t:{ru:"–ö—Ä–∏—á–∞—Ç—å –Ω–∞ –ø—Ç–∏—Ü",kz:"“ö“±—Å“õ–∞ –∞–π“õ–∞–π–ª–∞—É",en:"Shout at birds"}, ok:false},
     ], pts:5},
  ],
  l2: [
    {q:{ru:"–ü–æ—á–µ–º—É –ø–æ–∂–∞—Ä—ã –æ–ø–∞—Å–Ω—ã –¥–ª—è —Å—Ç–µ–ø–Ω—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö?",kz:"–î–∞–ª–∞ ”©—Ä—Ç—Ç–µ—Ä—ñ –Ω–µ–≥–µ “õ–∞—É—ñ–ø—Ç—ñ?",en:"Why are fires dangerous for steppe animals?"},
     a:[
      {t:{ru:"–ì–∏–±–Ω—É—Ç —É–∫—Ä—ã—Ç–∏—è –∏ –∫–ª–∞–¥–∫–∏, –∏—Å—á–µ–∑–∞–µ—Ç –∫–æ—Ä–º",kz:"–ü–∞–Ω–∞ –º–µ–Ω “±—è –∂–æ–π—ã–ª–∞–¥—ã, “õ–æ—Ä–µ–∫ –∞–∑–∞—è–¥—ã",en:"Shelters/nests burn; food disappears"}, ok:true},
      {t:{ru:"–û–Ω–∏ –¥–µ–ª–∞—é—Ç –≤–æ–∑–¥—É—Ö —á–∏—â–µ",kz:"–ê—É–∞ —Ç–∞–∑–∞—Ä–∞–¥—ã",en:"They make air cleaner"}, ok:false},
      {t:{ru:"–ñ–∏–≤–æ—Ç–Ω—ã–º –≤—Å—ë —Ä–∞–≤–Ω–æ",kz:"–ñ–∞–Ω—É–∞—Ä“ì–∞ –±”ô—Ä—ñ–±—ñ—Ä",en:"Animals don‚Äôt care"}, ok:false},
     ], pts:7},
    {q:{ru:"–ö–∞–∫–∞—è –ø—Ä–∏–≤—ã—á–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏—Ä–æ–¥–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",kz:"“ö–∞–π ”ô–¥–µ—Ç —Ç–∞–±–∏“ì–∞—Ç“õ–∞ –∫”©–±—ñ—Ä–µ–∫ –∫”©–º–µ–∫—Ç–µ—Å–µ–¥—ñ?",en:"Which habit helps nature most?"},
     a:[
      {t:{ru:"–ù–µ –º—É—Å–æ—Ä–∏—Ç—å –∏ –æ–±—ä—è—Å–Ω—è—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥—Ä—É–≥–∏–º",kz:"“ö–æ“õ—ã—Å —Ç–∞—Å—Ç–∞–º–∞—É –∂”ô–Ω–µ –µ—Ä–µ–∂–µ —Ç“Ø—Å—ñ–Ω–¥—ñ—Ä—É",en:"Don‚Äôt litter and teach others"}, ok:true},
      {t:{ru:"–°—Ä—ã–≤–∞—Ç—å —Ü–≤–µ—Ç—ã –¥–ª—è —Ñ–æ—Ç–æ",kz:"–§–æ—Ç–æ “Ø—à—ñ–Ω –≥“Ø–ª –∂“±–ª—É",en:"Pick flowers for photos"}, ok:false},
      {t:{ru:"–®—É–º–µ—Ç—å —É –≤–æ–¥—ã",kz:"–°—É–¥–∞ —à—É–ª–∞—É",en:"Make noise near water"}, ok:false},
     ], pts:7},
    {q:{ru:"–ö–∞–∫–∞—è –ø—Ä–∏—á–∏–Ω–∞ —á–∞—â–µ –≤—Å–µ–≥–æ —Å–æ–∫—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –≤–∏–¥–æ–≤?",kz:"–¢“Ø—Ä —Å–∞–Ω—ã –Ω–µ–≥–µ –∂–∏—ñ –∞–∑–∞—è–¥—ã?",en:"What often reduces populations?"},
     a:[
      {t:{ru:"–ü–æ—Ç–µ—Ä—è –º–µ—Å—Ç –æ–±–∏—Ç–∞–Ω–∏—è –∏ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ —á–µ–ª–æ–≤–µ–∫–∞",kz:"–ú–µ–∫–µ–Ω–Ω—ñ“£ –∂–æ“ì–∞–ª—É—ã, –∞–¥–∞–º ”ô—Å–µ—Ä—ñ",en:"Habitat loss and human impact"}, ok:true},
      {t:{ru:"–í–æ–ª—à–µ–±—Å—Ç–≤–æ",kz:"–°–∏“õ—ã—Ä",en:"Magic"}, ok:false},
      {t:{ru:"–ü—Ç–∏—Ü—ã —É–ª–µ—Ç–∞—é—Ç –Ω–∞–≤—Å–µ–≥–¥–∞ –±–µ–∑ –ø—Ä–∏—á–∏–Ω",kz:"–°–µ–±–µ–ø—Å—ñ–∑ “±—à–∞ –±–µ—Ä–µ–¥—ñ",en:"They leave for no reason"}, ok:false},
     ], pts:7},
    {q:{ru:"–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∫—É–ø–∏—Ç—å —á–µ—Ä–µ–ø–∞—Ö—É —Å —Ä—É–∫?",kz:"–ë—ñ—Ä–µ—É —Ç–∞—Å–±–∞“õ–∞–Ω—ã “õ–æ–ª–¥–∞–Ω —Å–∞—Ç—ã–ø –∞–ª—É–¥—ã “±—Å—ã–Ω—Å–∞?",en:"If someone sells a tortoise illegally?"},
     a:[
      {t:{ru:"–û—Ç–∫–∞–∑–∞—Ç—å—Å—è –∏ —Å–∫–∞–∑–∞—Ç—å –≤–∑—Ä–æ—Å–ª—ã–º",kz:"–ë–∞—Å —Ç–∞—Ä—Ç—É, –µ—Ä–µ—Å–µ–∫–∫–µ –∞–π—Ç—É",en:"Refuse and tell adults"}, ok:true},
      {t:{ru:"–ö—É–ø–∏—Ç—å, —á—Ç–æ–±—ã ‚Äò—Å–ø–∞—Å—Ç–∏‚Äô",kz:"‚Äò“ö“±—Ç“õ–∞—Ä—É‚Äô “Ø—à—ñ–Ω —Å–∞—Ç—ã–ø –∞–ª—É",en:"Buy to ‚Äòsave‚Äô"}, ok:false},
      {t:{ru:"–ù–µ–≤–∞–∂–Ω–æ",kz:"–ú–∞“£—ã–∑–¥—ã –µ–º–µ—Å",en:"Doesn‚Äôt matter"}, ok:false},
     ], pts:7},
    {q:{ru:"–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –∫ –≥–Ω—ë–∑–¥–∞–º –ø—Ç–∏—Ü?",kz:"–ù–µ–≥–µ “õ“±—Å “±—è—Å—ã–Ω–∞ –∂–∞“õ—ã–Ω–¥–∞–º–∞—É –∫–µ—Ä–µ–∫?",en:"Why keep away from nests?"},
     a:[
      {t:{ru:"–ü—Ç–∏—Ü—ã –º–æ–≥—É—Ç –±—Ä–æ—Å–∏—Ç—å –∫–ª–∞–¥–∫—É",kz:"“ö“±—Å “±—è—Å—ã–Ω —Ç–∞—Å—Ç–∞–ø –∫–µ—Ç—É—ñ –º“Ø–º–∫—ñ–Ω",en:"Birds may abandon eggs"}, ok:true},
      {t:{ru:"–¢–∞–∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ",kz:"“ö—ã–∑—ã“õ “Ø—à—ñ–Ω",en:"For fun"}, ok:false},
      {t:{ru:"–ù–∏—á–µ–≥–æ –Ω–µ –±—É–¥–µ—Ç",kz:"–ï—à—Ç–µ“£–µ –±–æ–ª–º–∞–π–¥—ã",en:"Nothing happens"}, ok:false},
     ], pts:7},
    {q:{ru:"–ß—Ç–æ –ø–æ–ª–µ–∑–Ω–µ–µ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞: —Ñ–æ—Ç–æ –∏–ª–∏ —Å–æ—Ä–≤–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç–æ–∫?",kz:"–ñ–æ–±–∞“ì–∞ –Ω–µ –ø–∞–π–¥–∞–ª—ã: —Ñ–æ—Ç–æ –º–∞, –∂“±–ª—ã–Ω“ì–∞–Ω –≥“Ø–ª –º–µ?",en:"What‚Äôs better: a photo or a picked flower?"},
     a:[
      {t:{ru:"–§–æ—Ç–æ ‚Äî –±–µ–∑ –≤—Ä–µ–¥–∞ –ø—Ä–∏—Ä–æ–¥–µ",kz:"–§–æ—Ç–æ ‚Äî —Ç–∞–±–∏“ì–∞—Ç“õ–∞ –∑–∏—è–Ω—Å—ã–∑",en:"Photo‚Äîno harm"}, ok:true},
      {t:{ru:"–°–æ—Ä–≤–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç–æ–∫",kz:"–ñ“±–ª—ã–Ω“ì–∞–Ω –≥“Ø–ª",en:"Picked flower"}, ok:false},
      {t:{ru:"–ë–µ–∑ —Ä–∞–∑–Ω–∏—Ü—ã",kz:"–ë”ô—Ä—ñ–±—ñ—Ä",en:"No difference"}, ok:false},
     ], pts:7},
  ],
  l3: [
    {q:{ru:"–ß—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º–æ–π —Å–∏–ª—å–Ω–æ–π –º–µ—Ä–æ–π –æ—Ö—Ä–∞–Ω—ã —Ä–µ–¥–∫–∏—Ö –≤–∏–¥–æ–≤?",kz:"–°–∏—Ä–µ–∫ —Ç“Ø—Ä–ª–µ—Ä–¥—ñ “õ–æ—Ä“ì–∞—É–¥—ã“£ –µ“£ –∫“Ø—à—Ç—ñ —à–∞—Ä–∞—Å—ã?",en:"What is the strongest conservation measure?"},
     a:[
      {t:{ru:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Å—Ç –æ–±–∏—Ç–∞–Ω–∏—è + –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞—Ä—É—à–µ–Ω–∏–π",kz:"–ú–µ–∫–µ–Ω–¥—ñ —Å–∞“õ—Ç–∞—É + –∑–∞“£ –±“±–∑—É–¥—ã –±–∞“õ—ã–ª–∞—É",en:"Habitat protection + enforcement"}, ok:true},
      {t:{ru:"–†–∞–∑—Ä–µ—à–∏—Ç—å –æ—Ç–ª–æ–≤",kz:"–ê—É–ª–∞—É“ì–∞ —Ä“±“õ—Å–∞—Ç",en:"Allow capture"}, ok:false},
      {t:{ru:"–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É",kz:"–ï–ª–µ–º–µ—É",en:"Ignore"}, ok:false},
     ], pts:10},
    {q:{ru:"–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å —à–∫–æ–ª—å–Ω—ã–π QR-—Å—Ç–µ–Ω–¥ –ø–æ–ª–µ–∑–Ω—ã–º?",kz:"–ú–µ–∫—Ç–µ–ø—Ç–µ–≥—ñ QR-—Å—Ç–µ–Ω–¥—Ç—ñ “õ–∞–ª–∞–π –ø–∞–π–¥–∞–ª—ã –µ—Ç—É–≥–µ –±–æ–ª–∞–¥—ã?",en:"How to make a school QR stand useful?"},
     a:[
      {t:{ru:"–ö–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ + —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç + –¥–µ–π—Å—Ç–≤–∏—è",kz:"“ö—ã—Å“õ–∞ –µ—Ä–µ–∂–µ + —Å—ñ–ª—Ç–µ–º–µ + ”ô—Ä–µ–∫–µ—Ç",en:"Short rules + link + actions"}, ok:true},
      {t:{ru:"–¢–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –±–µ–∑ —Å–º—ã—Å–ª–∞",kz:"–¢–µ–∫ –º–∞“ì—ã–Ω–∞—Å—ã–∑ —Å—É—Ä–µ—Ç",en:"Only a picture"}, ok:false},
      {t:{ru:"–î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ 5 —Å—Ç—Ä–∞–Ω–∏—Ü",kz:"5 –±–µ—Ç “±–∑—ã–Ω –º”ô—Ç—ñ–Ω",en:"5-page text"}, ok:false},
     ], pts:10},
    {q:{ru:"–ß—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –¥–ª—è –æ—Ö—Ä–∞–Ω—ã: –æ–¥–∏–Ω–æ—á–Ω—ã–µ –∞–∫—Ü–∏–∏ –∏–ª–∏ —Å–∏—Å—Ç–µ–º–∞?",kz:"“ö–æ—Ä“ì–∞—É–¥–∞ –Ω–µ —Ç–∏—ñ–º–¥—ñ: –±—ñ—Ä —Ä–µ—Ç—Ç—ñ–∫ –∞–∫—Ü–∏—è –º–∞, –∂“Ø–π–µ –º–µ?",en:"What‚Äôs more effective: one-time actions or a system?"},
     a:[
      {t:{ru:"–°–∏—Å—Ç–µ–º–∞: –ø—Ä–æ—Å–≤–µ—â–µ–Ω–∏–µ + –ø—Ä–∞–≤–∏–ª–∞ + –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥",kz:"–ñ“Ø–π–µ: —Ç“Ø—Å—ñ–Ω–¥—ñ—Ä—É + –µ—Ä–µ–∂–µ + –±–∞“õ—ã–ª–∞—É",en:"System: education + rules + monitoring"}, ok:true},
      {t:{ru:"–¢–æ–ª—å–∫–æ –ø–ª–∞–∫–∞—Ç—ã",kz:"–¢–µ–∫ –ø–ª–∞–∫–∞—Ç",en:"Only posters"}, ok:false},
      {t:{ru:"–ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å",kz:"–ï—à—Ç–µ“£–µ —ñ—Å—Ç–µ–º–µ—É",en:"Do nothing"}, ok:false},
     ], pts:10},
    {q:{ru:"–ö–∞–∫–∞—è —Å–≤—è–∑–∫–∞ –ª—É—á—à–µ –¥–ª—è –≤–æ–¥–æ—ë–º–æ–≤ –ë–∞–ª—Ö–∞—à–∞?",kz:"–ë–∞–ª“õ–∞—à —Å—É –∞–π–¥—ã–Ω–¥–∞—Ä—ã “Ø—à—ñ–Ω “õ–∞–π—Å—ã—Å—ã –¥“±—Ä—ã—Å?",en:"Best combo for Balkhash waters?"},
     a:[
      {t:{ru:"–ß–∏—Å—Ç—ã–µ –±–µ—Ä–µ–≥–∞ + –∫–æ–Ω—Ç—Ä–æ–ª—å –º—É—Å–æ—Ä–∞ + –∫—É–ª—å—Ç—É—Ä–∞ –æ—Ç–¥—ã—Ö–∞",kz:"–¢–∞–∑–∞ –∂–∞“ì–∞–ª–∞—É + “õ–æ“õ—ã—Å –±–∞“õ—ã–ª–∞—É + –º”ô–¥–µ–Ω–∏–µ—Ç",en:"Clean shores + waste control + responsible recreation"}, ok:true},
      {t:{ru:"–ë–æ–ª—å—à–µ —à—É–º–∞ —É –≤–æ–¥—ã",kz:"–°—É–¥–∞ —à—É –∫”©–±–µ–π—Ç—É",en:"More noise"}, ok:false},
      {t:{ru:"–ü–æ–¥—Ö–æ–¥–∏—Ç—å –∫ –∫–æ–ª–æ–Ω–∏—è–º –ø—Ç–∏—Ü",kz:"“ö“±—Å –∫–æ–ª–æ–Ω–∏—è—Å—ã–Ω–∞ –∂–∞“õ—ã–Ω–¥–∞—É",en:"Approach colonies"}, ok:false},
     ], pts:10},
    {q:{ru:"–ü–æ—á–µ–º—É –Ω–µ–∑–∞–∫–æ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è –∂–∏–≤–æ—Ç–Ω—ã–º–∏ –æ–ø–∞—Å–Ω–∞?",kz:"–ó–∞“£—Å—ã–∑ —Å–∞—É–¥–∞ –Ω–µ–≥–µ “õ–∞—É—ñ–ø—Ç—ñ?",en:"Why is illegal wildlife trade dangerous?"},
     a:[
      {t:{ru:"–£–Ω–∏—á—Ç–æ–∂–∞–µ—Ç –ø–æ–ø—É–ª—è—Ü–∏–∏ –∏ —Å—Ç–∏–º—É–ª–∏—Ä—É–µ—Ç –æ—Ç–ª–æ–≤",kz:"–ü–æ–ø—É–ª—è—Ü–∏—è–Ω—ã –∂–æ—è–¥—ã, –∞—É–ª–∞—É–¥—ã –∞—Ä—Ç—Ç—ã—Ä–∞–¥—ã",en:"It destroys populations and drives capture"}, ok:true},
      {t:{ru:"–≠—Ç–æ ‚Äò–ø–æ–º–æ—â—å‚Äô –ø—Ä–∏—Ä–æ–¥–µ",kz:"–ë“±–ª ‚Äò–∫”©–º–µ–∫‚Äô",en:"It ‚Äòhelps‚Äô nature"}, ok:false},
      {t:{ru:"–ù–µ –≤–ª–∏—è–µ—Ç",kz:"”ò—Å–µ—Ä –µ—Ç–ø–µ–π–¥—ñ",en:"No effect"}, ok:false},
     ], pts:10},
    {q:{ru:"–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ QR-—Å—Ç–µ–Ω–¥, —á—Ç–æ–±—ã –æ–Ω —Ä–∞–±–æ—Ç–∞–ª?",kz:"QR-—Å—Ç–µ–Ω–¥–∫–µ –Ω–µ “õ–æ—Å—É –∫–µ—Ä–µ–∫?",en:"What should a QR stand include?"},
     a:[
      {t:{ru:"–ö–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ + —Å—Å—ã–ª–∫–∞ + –¥–µ–π—Å—Ç–≤–∏—è ‚Äò—á—Ç–æ –¥–µ–ª–∞—Ç—å‚Äô",kz:"“ö—ã—Å“õ–∞ –µ—Ä–µ–∂–µ + —Å—ñ–ª—Ç–µ–º–µ + ”ô—Ä–µ–∫–µ—Ç",en:"Short rules + link + actions"}, ok:true},
      {t:{ru:"–¢–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫—É",kz:"–¢–µ–∫ —Å—É—Ä–µ—Ç",en:"Only a picture"}, ok:false},
      {t:{ru:"–¢–æ–ª—å–∫–æ –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–∞ 2 —Å—Ç—Ä–∞–Ω–∏—Ü—ã",kz:"2 –±–µ—Ç “±–∑—ã–Ω –º”ô—Ç—ñ–Ω",en:"Two pages of text"}, ok:false},
     ], pts:10},
  ]
};

const LEVEL_META = {
  l1:{name:{ru:"–£—Ä–æ–≤–µ–Ω—å 1",kz:"–î–µ“£–≥–µ–π 1",en:"Level 1"}},
  l2:{name:{ru:"–£—Ä–æ–≤–µ–Ω—å 2",kz:"–î–µ“£–≥–µ–π 2",en:"Level 2"}},
  l3:{name:{ru:"–£—Ä–æ–≤–µ–Ω—å 3",kz:"–î–µ“£–≥–µ–π 3",en:"Level 3"}}
};

let chosenLevel = localStorage.getItem("eco_level") || "";
let score = 0;

function renderLevel(boxId, items, levelKey){
  const box = $(boxId);
  box.innerHTML = "";
  items.forEach((it, idx)=>{
    const q = document.createElement("div");
    q.className = "q";
    const qText = it.q[lang] || it.q.ru;
    q.innerHTML = `<p>${idx+1}. ${qText}</p>`;
    it.a.forEach((opt, j)=>{
      const id = `${levelKey}_${idx}_${j}`;
      const line = document.createElement("div");
      line.className = "opt";
      line.innerHTML = `
        <input type="radio" name="${levelKey}_${idx}" id="${id}" value="${j}">
        <label for="${id}">${(opt.t[lang]||opt.t.ru)}</label>
      `;
      q.appendChild(line);
    });
    box.appendChild(q);
  });
}

function renderAll(){
  renderLevel("#l1Box", QUIZ.l1, "l1");
  renderLevel("#l2Box", QUIZ.l2, "l2");
  renderLevel("#l3Box", QUIZ.l3, "l3");

  const situ = {
    ru:[
      "–¢—ã –≤–∏–¥–∏—à—å —á–µ—Ä–µ–ø–∞—Ö—É —É –¥–æ—Ä–æ–≥–∏. –ß—Ç–æ —Å–¥–µ–ª–∞–µ—à—å, —á—Ç–æ–±—ã –Ω–µ –Ω–∞–≤—Ä–µ–¥–∏—Ç—å?",
      "–ö—Ç–æ-—Ç–æ —Ö–æ—á–µ—Ç —Å–æ—Ä–≤–∞—Ç—å —Ä–µ–¥–∫–∏–π —Ü–≤–µ—Ç–æ–∫ ¬´–Ω–∞ –±—É–∫–µ—Ç¬ª. –ö–∞–∫ –æ–±—ä—è—Å–Ω–∏—à—å –ø—Ä–∞–≤–∏–ª–∞?",
      "–ù–∞ –±–µ—Ä–µ–≥—É –æ–∑–µ—Ä–∞ –º—É—Å–æ—Ä. –ö–∞–∫–∏–µ 3 –¥–µ–π—Å—Ç–≤–∏—è —Å–¥–µ–ª–∞—é—Ç –º–µ—Å—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –¥–ª—è –ø—Ç–∏—Ü?"
    ],
    kz:[
      "–ñ–æ–ª –º–∞“£—ã–Ω–¥–∞ —Ç–∞—Å–±–∞“õ–∞–Ω—ã –∫”©—Ä–¥—ñ“£. –ó–∏—è–Ω –∫–µ–ª—Ç—ñ—Ä–º–µ—É “Ø—à—ñ–Ω –Ω–µ —ñ—Å—Ç–µ–π—Å—ñ“£?",
      "–ë—ñ—Ä–µ—É —Å–∏—Ä–µ–∫ –≥“Ø–ª–¥—ñ ¬´–±—É–∫–µ—Ç–∫–µ¬ª –∂“±–ª—ã–ø –∞–ª–º–∞“õ. –ï—Ä–µ–∂–µ–Ω—ñ “õ–∞–ª–∞–π —Ç“Ø—Å—ñ–Ω–¥—ñ—Ä–µ—Å—ñ“£?",
      "–ö”©–ª –∂–∞“ì–∞—Å—ã–Ω–¥–∞ “õ–æ“õ—ã—Å –±–∞—Ä. “ö“±—Å—Ç–∞—Ä“ì–∞ “õ–∞—É—ñ–ø—Å—ñ–∑ –µ—Ç—É “Ø—à—ñ–Ω 3 ”ô—Ä–µ–∫–µ—Ç –∞—Ç–∞."
    ],
    en:[
      "You see a tortoise near a road. What will you do to avoid harm?",
      "Someone wants to pick a rare flower. How will you explain the rules?",
      "There is trash on the lake shore. Name 3 actions to make it safer for birds."
    ]
  };
  const list = $("#situList");
  list.innerHTML="";
  (situ[lang]||situ.ru).forEach(s=>{
    const li=document.createElement("li"); li.textContent=s; list.appendChild(li);
  });

  applyActiveButtons();
}

function setChosenLevel(lv){
  chosenLevel = lv;
  localStorage.setItem("eco_level", chosenLevel);

  $("#stLevel").textContent = (LEVEL_META[lv]?.name[lang] || LEVEL_META[lv]?.name.ru || "‚Äî");
  $("#btnSetL1").classList.toggle("active", lv==="l1");
  $("#btnSetL2").classList.toggle("active", lv==="l2");
  $("#btnSetL3").classList.toggle("active", lv==="l3");

  ["lvl1","lvl2","lvl3"].forEach((id,i)=>{
    const d = $("#"+id);
    const key = "l"+(i+1);
    d.open = (key===lv);
  });
}

let secondsLeft = 30*60;
let timerId = null;
let started = false;

function fmtTime(s){
  s = Math.max(0, Math.floor(s));
  const mm = String(Math.floor(s/60)).padStart(2,"0");
  const ss = String(s%60).padStart(2,"0");
  return `${mm}:${ss}`;
}
function updateTimerUI(){ $("#stTime").textContent = fmtTime(secondsLeft); }

function startTimer(){
  if(started) return;
  const nm = $("#studentName").value.trim();
  if(!nm){
    toast(lang==="ru" ? "–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏ –∏–º—è." : lang==="kz" ? "–ê–ª–¥—ã–º–µ–Ω –∞—Ç—ã“£–¥—ã –∂–∞–∑." : "Enter your name first.");
    $("#studentName").focus();
    return;
  }
  started = true;
  $("#stName").textContent = nm;
  secondsLeft = 30*60;
  updateTimerUI();
  timerId = setInterval(()=>{
    secondsLeft -= 1;
    updateTimerUI();
    if(secondsLeft<=0){
      stopTimer();
      toast(lang==="ru" ? "–í—Ä–µ–º—è –≤—ã—à–ª–æ! –ü—Ä–æ–≤–µ—Ä—å –æ—Ç–≤–µ—Ç—ã –∏ –ø–æ–ª—É—á–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç." : lang==="kz" ? "–£–∞“õ—ã—Ç –±—ñ—Ç—Ç—ñ! –ñ–∞—É–∞–±—ã“£–¥—ã —Ç–µ–∫—Å–µ—Ä." : "Time is up! Check and get certificate.");
    }
  }, 1000);
  toast(lang==="ru" ? "–ú–∏—Å—Å–∏—è –Ω–∞—á–∞–ª–∞—Å—å! –£–¥–∞—á–∏, –•—Ä–∞–Ω–∏—Ç–µ–ª—å!" : lang==="kz" ? "–ú–∏—Å—Å–∏—è –±–∞—Å—Ç–∞–ª–¥—ã! –°”ô—Ç—Ç—ñ–ª—ñ–∫!" : "Mission started! Good luck!");
}
function stopTimer(){
  if(timerId) clearInterval(timerId);
  timerId = null;
}
function resetAll(){
  stopTimer();
  started = false;
  secondsLeft = 30*60;
  score = 0;
  $("#stScore").textContent = score;
  $("#stTime").textContent = fmtTime(secondsLeft);
  $("#stName").textContent = "‚Äî";
  $("#studentName").value = "";
  $("#certWrap").style.display="none";
  $$("input[type=radio]").forEach(r=>r.checked=false);
  $("#notes").value="";
  toast(lang==="ru" ? "–°–±—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω." : lang==="kz" ? "“ö–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—ñ–ª–¥—ñ." : "Reset done.");
}

function calcScore(){
  let total = 0;
  ["l1","l2","l3"].forEach(lv=>{
    const items = QUIZ[lv];
    items.forEach((it, idx)=>{
      const picked = document.querySelector(`input[name="${lv}_${idx}"]:checked`);
      if(!picked) return;
      const j = Number(picked.value);
      if(it.a[j] && it.a[j].ok) total += it.pts;
    });
  });
  return total;
}
function updateScoreUI(){
  score = calcScore();
  $("#stScore").textContent = score;
}

function stopSpeak(){ try{ speechSynthesis.cancel(); }catch(e){} }
function pickVoice(preferLang){
  const voices = speechSynthesis.getVoices ? speechSynthesis.getVoices() : [];
  const lc = (preferLang||"ru").toLowerCase();
  let v = voices.find(x => (x.lang||"").toLowerCase().startsWith(lc));
  if(v) return v;
  if(lc==="kz"){
    v = voices.find(x => (x.lang||"").toLowerCase().startsWith("ru"));
    if(v) return v;
  }
  if(lc!=="en"){
    v = voices.find(x => (x.lang||"").toLowerCase().startsWith("en"));
    if(v) return v;
  }
  return voices[0] || null;
}
function speakText(text){
  stopSpeak();
  if(!("speechSynthesis" in window)){
    alert(lang==="ru" ? "–û–∑–≤—É—á–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ." : lang==="kz" ? "–ë“±–ª –±—Ä–∞—É–∑–µ—Ä–¥–µ –¥—ã–±—ã—Å—Ç–∞—É –∂–æ“õ." : "Speech not available in this browser.");
    return;
  }
  const u = new SpeechSynthesisUtterance(text);
  u.rate = 1.0;
  u.pitch = 1.05;
  const v = pickVoice(lang);
  if(v) u.voice = v;
  speechSynthesis.speak(u);
}

function gradeByScore(sc){
  if(sc >= 80) return {ru:"–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –•—Ä–∞–Ω–∏—Ç–µ–ª—å",kz:"–ê“£—ã–∑ –°–∞“õ—à—ã",en:"Legendary Guardian"};
  if(sc >= 55) return {ru:"–°–∏–ª—å–Ω—ã–π –•—Ä–∞–Ω–∏—Ç–µ–ª—å",kz:"–ú—ã“õ—Ç—ã –°–∞“õ—à—ã",en:"Strong Guardian"};
  if(sc >= 35) return {ru:"–Æ–Ω—ã–π –•—Ä–∞–Ω–∏—Ç–µ–ª—å",kz:"–ñ–∞—Å –°–∞“õ—à—ã",en:"Young Guardian"};
  return {ru:"–£—á–µ–Ω–∏–∫ –•—Ä–∞–Ω–∏—Ç–µ–ª—è",kz:"–°–∞“õ—à—ã —à”ô–∫—ñ—Ä—Ç—ñ",en:"Guardian Apprentice"};
}

function showCert(){
  updateScoreUI();
  const nm = ($("#studentName").value.trim() || $("#stName").textContent || "‚Äî");
  $("#certName").textContent = nm;

  const g = gradeByScore(score);
  $("#sealText").innerHTML = (lang==="ru" ? "–•–†–ê–ù–ò–¢–ï–õ–¨<br>–ö–†–ê–°–ù–û–ô –ö–ù–ò–ì–ò" : lang==="kz" ? "“ö–´–ó–´–õ –ö–Ü–¢–ê–ü<br>–°–ê“ö–®–´–°–´" : "RED BOOK<br>GUARDIAN");

  $("#certScore").textContent = (lang==="ru" ? "–ë–∞–ª–ª—ã: " : lang==="kz" ? "“∞–ø–∞–π: " : "Score: ") + score;
  $("#certLevel").textContent = (lang==="ru" ? "–£—Ä–æ–≤–µ–Ω—å: " : lang==="kz" ? "–î–µ“£–≥–µ–π: " : "Level: ") + (LEVEL_META[chosenLevel]?.name[lang] || "‚Äî");
  $("#certTime").textContent  = (lang==="ru" ? "–í—Ä–µ–º—è: " : lang==="kz" ? "–£–∞“õ—ã—Ç: " : "Time: ") + fmtTime(30*60 - secondsLeft);
  const d = new Date();
  $("#certDate").textContent  = (lang==="ru" ? "–î–∞—Ç–∞: " : lang==="kz" ? "–ö“Ø–Ω—ñ: " : "Date: ") + d.toLocaleDateString();

  $("#certSub").textContent = t("certSub") + " ‚Ä¢ " + (g[lang]||g.ru);

  $("#certWrap").style.display="block";
  $("#certWrap").scrollIntoView({behavior:"smooth", block:"start"});
}

function setLang(next){
  lang = next;
  localStorage.setItem(LS_LANG, lang);
  setStaticText();
  renderAll();
  setChosenLevel(chosenLevel || "l1");
  updateScoreUI();
}
function setBg(next){
  bg = next;
  document.body.dataset.bg = bg;
  localStorage.setItem(LS_BG, bg);
  applyActiveButtons();
}

$$("[data-lang]").forEach(b=>b.addEventListener("click", ()=>setLang(b.dataset.lang)));
$$("[data-bg]").forEach(b=>b.addEventListener("click", ()=>setBg(b.dataset.bg)));

$("#btnStart").addEventListener("click", startTimer);
$("#btnReset").addEventListener("click", resetAll);
$("#btnCheck").addEventListener("click", ()=>{
  if(!chosenLevel) setChosenLevel("l1");
  showCert();
});
$("#btnPrint").addEventListener("click", ()=>window.print());
$("#btnSetL1").addEventListener("click", ()=>setChosenLevel("l1"));
$("#btnSetL2").addEventListener("click", ()=>setChosenLevel("l2"));
$("#btnSetL3").addEventListener("click", ()=>setChosenLevel("l3"));

document.addEventListener("change", (e)=>{
  if(e.target && e.target.matches('input[type="radio"]')){
    updateScoreUI();
  }
});

$("#btnSpeakHello").addEventListener("click", ()=>{
  const text = {
    ru:"–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –•—Ä–∞–Ω–∏—Ç–µ–ª–∏! –Ø ‚Äî –§–µ—è –ß–µ—Ä–µ–ø–∞—à—å–µ–≥–æ —É–≥–æ–ª–∫–∞ ‚Äî –ö—Ä–∞—Å–Ω–æ–∫–Ω–∏–∂–Ω–∏—Ü–∞. –°–µ–≥–æ–¥–Ω—è –º—ã –∑–∞—â–∏—â–∞–µ–º –°—Ä–µ–¥–Ω–µ–∞–∑–∏–∞—Ç—Å–∫—É—é —á–µ—Ä–µ–ø–∞—Ö—É –∏ –≤—Å–µ—Ö –≥–µ—Ä–æ–µ–≤ –ö—Ä–∞—Å–Ω–æ–π –∫–Ω–∏–≥–∏. –í—ã–ø–æ–ª–Ω—è–π –∑–∞–¥–∞–Ω–∏—è, –Ω–∞–±–∏—Ä–∞–π –±–∞–ª–ª—ã –∏ –ø–æ–ª—É—á–∞–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç!",
    kz:"–°”ô–ª–µ–º, –°–∞“õ—à—ã–ª–∞—Ä! –ú–µ–Ω ‚Äî –¢–∞—Å–±–∞“õ–∞ –±“±—Ä—ã—à—ã–Ω—ã“£ –§–µ—è—Å—ã. –ë“Ø–≥—ñ–Ω –û—Ä—Ç–∞–∞–∑–∏—è–ª—ã“õ —Ç–∞—Å–±–∞“õ–∞–Ω—ã –∂”ô–Ω–µ “ö—ã–∑—ã–ª –∫—ñ—Ç–∞–ø “õ–∞“ª–∞—Ä–º–∞–Ω–¥–∞—Ä—ã–Ω “õ–æ—Ä“ì–∞–π–º—ã–∑. –¢–∞–ø—Å—ã—Ä–º–∞–ª–∞—Ä–¥—ã –æ—Ä—ã–Ω–¥–∞–ø, “±–ø–∞–π –∂–∏–Ω–∞–ø, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∞–ª!",
    en:"Hello, Guardians! I‚Äôm the Fairy of the Turtle Corner. Today we protect the Central Asian tortoise and Red Book heroes. Complete tasks, earn points, and get your certificate!"
  };
  speakText(text[lang]||text.ru);
});
$("#btnSpeakRules").addEventListener("click", ()=>{
  const text = {
    ru:"–ü—Ä–∞–≤–∏–ª–∞ –•—Ä–∞–Ω–∏—Ç–µ–ª—è: –Ω–µ –±–µ—Ä–∏ –∂–∏–≤–æ—Ç–Ω—ã—Ö –∏–∑ –ø—Ä–∏—Ä–æ–¥—ã –¥–æ–º–æ–π; –Ω–µ —Ç—Ä–æ–≥–∞–π –≥–Ω—ë–∑–¥–∞ –∏ –∫–ª–∞–¥–∫–∏; –Ω–µ –∂–≥–∏ —Ç—Ä–∞–≤—É; –Ω–µ –æ—Å—Ç–∞–≤–ª—è–π –º—É—Å–æ—Ä; —Ä–∞—Å—Å–∫–∞–∂–∏ –¥—Ä—É–≥–∏–º –ø—Ä–∞–≤–∏–ª–∞ –∏ —Å–¥–µ–ª–∞–π QR-–ø–∞–º—è—Ç–∫—É.",
    kz:"–°–∞“õ—à—ã –µ—Ä–µ–∂–µ–ª–µ—Ä—ñ: –∂–∞–Ω—É–∞—Ä–¥—ã —Ç–∞–±–∏“ì–∞—Ç—Ç–∞–Ω “Ø–π–≥–µ ”ô–∫–µ–ª–º–µ; “±—è –º–µ–Ω –∂“±–º—ã—Ä—Ç“õ–∞“ì–∞ —Ç–∏–º–µ; —à”©–ø—Ç—ñ ”©—Ä—Ç–µ–º–µ; “õ–æ“õ—ã—Å “õ–∞–ª–¥—ã—Ä–º–∞; –µ—Ä–µ–∂–µ–Ω—ñ —Ç“Ø—Å—ñ–Ω–¥—ñ—Ä—ñ–ø, QR-–∂–∞–¥—ã–Ω–∞–º–∞ –∂–∞—Å–∞.",
    en:"Guardian rules: don‚Äôt take wildlife home; don‚Äôt disturb nests/eggs; don‚Äôt burn grass; don‚Äôt litter; teach others and make a QR memo."
  };
  speakText(text[lang]||text.ru);
});
$("#btnSpeakCert").addEventListener("click", ()=>{
  const nm = ($("#studentName").value.trim() || $("#stName").textContent || "‚Äî");
  const text = {
    ru:`–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Ö—Ä–∞–Ω–∏—Ç–µ–ª—è –≤—ã–¥–∞–Ω —É—á–∞—Å—Ç–Ω–∏–∫—É: ${nm}. –ù–∞–±—Ä–∞–Ω–æ –±–∞–ª–ª–æ–≤: ${score}. –°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞—â–∏—Ç—É –ß–µ—Ä–µ–ø–∞—à—å–µ–≥–æ —É–≥–æ–ª–∫–∞!`,
    kz:`–°–∞“õ—à—ã —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã: “õ–∞—Ç—ã—Å—É—à—ã ${nm}. “∞–ø–∞–π: ${score}. –¢–∞—Å–±–∞“õ–∞ –±“±—Ä—ã—à—ã–Ω “õ–æ—Ä“ì–∞“ì–∞–Ω—ã“£ “Ø—à—ñ–Ω —Ä–∞—Ö–º–µ—Ç!`,
    en:`Guardian certificate awarded to ${nm}. Score ${score}. Thank you for protecting the Turtle Corner!`
  };
  speakText(text[lang]||text.ru);
});
$("#btnStop").addEventListener("click", stopSpeak);
$("#btnStop2").addEventListener("click", stopSpeak);

if("speechSynthesis" in window){
  speechSynthesis.onvoiceschanged = ()=>{};
}

(function init(){
  setBg(bg);
  setStaticText();
  renderAll();
  setChosenLevel(chosenLevel || "l1");
  $("#stName").textContent = "‚Äî";
  $("#stScore").textContent = "0";
  $("#stTime").textContent = "30:00";
})();
</script>
</body>
</html>
